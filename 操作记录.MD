## 1. 网络规划
```
服务器A (Master): 43.163.87.253(172.22.0.7)
服务器B (Worker): 43.134.36.83(172.22.16.3)
服务器C (Worker): 43.156.113.243(172.22.16.8)
```


## 2. 安装准备（所有节点）
```

# 关闭Swap
swapoff -a
sed -i '/swap/s/^/#/' /etc/fstab


# 启用IP转发
# 直接写入参数值
echo 1 | sudo tee /proc/sys/net/ipv4/ip_forward
# 显示当前所有sysctl参数
sudo sysctl -a | grep ip_forward
cat /proc/sys/net/ipv4/ip_forward


# 启用 br_netfilter 模块
modprobe br_netfilter
echo "br_netfilter" >> /etc/modules
cat /proc/sys/net/bridge/bridge-nf-call-iptables
echo "net.bridge.bridge-nf-call-iptables = 1" >> /etc/sysctl.conf
sysctl -p


# 安装socat
sudo apt update
sudo apt install socat -y


# 安装docker(https://docs.docker.com/engine/install/debian/)
# Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl -y
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/debian/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc

# Add the repository to Apt sources:
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/debian \
  $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin -y


# 安装cri
wget https://github.com/Mirantis/cri-dockerd/releases/download/v0.3.15/cri-dockerd_0.3.15.3-0.debian-bookworm_amd64.deb
sudo dpkg -i cri-dockerd_0.3.15.3-0.debian-bookworm_amd64.deb


# 安装kubeadm(https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/install-kubeadm/)
sudo apt-get update
sudo apt-get install -y apt-transport-https ca-certificates curl gpg
# 如果 `/etc/apt/keyrings` 目录不存在，则应在 curl 命令之前创建它，请阅读下面的注释。
# sudo mkdir -p -m 755 /etc/apt/keyrings
curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.32/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg

# 此操作会覆盖 /etc/apt/sources.list.d/kubernetes.list 中现存的所有配置。
echo 'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.32/deb/ /' | sudo tee /etc/apt/sources.list.d/kubernetes.list
sudo apt-get update
sudo apt-get install -y kubelet kubeadm kubectl
sudo apt-mark hold kubelet kubeadm kubectl

```